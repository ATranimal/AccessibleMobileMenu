<script src="https://hammerjs.github.io/dist/hammer.min.js"></script>
<script src="https://hammerjs.github.io/dist/hammer-time.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>

<canvas id="image" width="200" height="200" style="border:1px solid #000000;"></canvas>

</br>

<p class="dish" id="<%= dish.id %>"><%= dish.name %> <i>$<%= dish.price %></i> <%= dish.description %> </p>

</br> 

<input id="dislike" type="submit" value="Dislike" />
<input id="like"type="submit" value="Like" />

<script type='text/javascript'>
    var dish = document.getElementsByClassName("dish");
    var dishID = dish[0].id;
    var canvas = document.getElementById("image");

    var hammertime = new Hammer(canvas);
    hammertime.on('swipe', function(ev) {
        if (ev.velocityX < 0){
            setLocalStorage(dishID, false);
        }
        else {
            setLocalStorage(dishID, true);
        }
    });

    $(document).ready(function(){
        $('#like').click(function(){
            setLocalStorage(dishID, true)
        });
        $('#dislike').click(function(){
            setLocalStorage(dishID, false)
        });
    });

    function setLocalStorage(id, increase) {
        //Check if value already exists, if so just modify
        if (id in localStorage) {
            if (increase) {
                localStorage.setItem(id, parseInt(localStorage.getItem(id)) + 1);
            }
            else {
                localStorage.setItem(id, parseInt(localStorage.getItem(id)) - 1);
            }
        }

        //If not, create new storage + increment/decrease
        else {
            if (increase) {
                localStorage.setItem(id, 1);
            }
            else {
                localStorage.setItem(id, -1);
            }
        }

        window.location.reload(false); 
    }
    
</script>